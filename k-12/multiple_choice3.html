<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Third Multiple Choice</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <!--[if lte IE 8]><script>document.createElement(main)</script><![endif]-->
    <link rel="stylesheet" href="../elements.css">
    <style>
      /* demo-specific styles */
      main {
        width: 33%;
        max-width: 25em;
        margin: 0 auto;
        padding: 1em;
      }
      .box {
        padding: 1em;
        margin-bottom: 1em;
        border: 1px solid #c7c7c7;
      }
      .points {
        font-weight: bold;
      }
      .tries {
        color: #6a7070;
      }
      form, fieldset {
        margin: 0;
        padding: 0;
        border: 0;
      }
      legend {
        font-size: 1.1em;
        font-weight: bold;
        margin-bottom: .5em;
      }
      legend~div {
        padding-right: 3.8em;
      }
      /* bigger than in Elements */
      input[type="radio"] ~ span {
        top: 2px;
        left: 2px;
        padding: 2px 6px 6px 2px;
      }

      input[type="radio"] ~ span svg {
        height: 9px;
        width: 9px;
      }
      .answer {
        position: absolute;
        right: 0;
        top: 2px;
        margin: 0;
      }
      .correct {
        color: #038238;
      }
      .incorrect {
        color: #db0020;
      }
      [role=alert] h2 {
        margin-top: 1.5em; 
        font-size: 1.1em;
        font-weight: bold; 
        line-height: 1.2em;
      }
      [role=alert] h2+p {
        color: #6a7070;
      }
      button[type=submit],
      a.pe-btn__primary {
        display: block;
        box-sizing: border-box;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <main>
      <div class="box">
        <p class="points">[1 pt]</p>
        <h1>[ Question Title ]</h1>
        <p>[ Begin by reading the news article, ECB must cut rates or risk crisis again lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla ac aliquet dui, et ornare libero. ]</p>
      </div>
      <div class="box">
        <p role="status" class="tries">4 tries left</p>
        <form method="get" action="">
          <fieldset>
            <legend>Which of the following is NOT part of the procedure for writing an equation from a word problem?</legend>
            <div class="pe-radio">
              <input type="radio" name="n1" id="wp">
              <label for="wp">A. Write an expression to represent each unknown quantity in terms of the variable.</label>
              <span>
                <svg aria-hidden="true"
                     focusable="false"
                     class="pe-icon--radio-dot">
                  <use xlink:href="#new-notification-9"></use>
                </svg>
              </span>
            </div>
            <div class="pe-radio">
              <input type="radio" name="n1" id="wp2">
              <label for="wp2">B. Use a given relationship in the problem or an appropriate formula to write an equation.</label>
              <span>
                <svg aria-hidden="true"
                     focusable="false"
                     class="pe-icon--radio-dot">
                  <use xlink:href="#new-notification-9"></use>
                </svg>
              </span>
            </div>
            <div class="pe-radio">
              <input type="radio" name="n1" id="wp3">
              <label for="wp3">C. Solve for the unknown quantity.</label>
              <span>
                <svg aria-hidden="true"
                     focusable="false"
                     class="pe-icon--radio-dot">
                  <use xlink:href="#new-notification-9"></use>
                </svg>
              </span>
            </div>
            <div class="pe-radio">
              <input type="radio" name="n1" id="wp4">
              <label for="wp4">D. Choose a variable to represent an unknown quantity.</label>
              <span>
                <svg aria-hidden="true"
                     focusable="false"
                     class="pe-icon--radio-dot">
                  <use xlink:href="#new-notification-9"></use>
                </svg>
              </span>
            </div>
            <div class="pe-radio">
              <input type="radio" name="n1" id="wp5">
              <label for="wp5">E. Lorem ipsum.</label>
              <span>
                <svg aria-hidden="true"
                     focusable="false"
                     class="pe-icon--radio-dot">
                  <use xlink:href="#new-notification-9"></use>
                </svg>
              </span>
            </div>
            <div role="alert"> </div>
            <button type="submit" class="pe-btn" disabled>Submit</button>
          </fieldset>
        </form>
      </div>
    </main>

    <template id="answer_correct">
      <p class="answer correct">
        <svg role="img" aria-labelledby="q1_correct" focusable="false" class="pe-icon--check-lg-24">
          <title id="q1_correct">Correct answer</title>
          <use xlink:href="#check-lg-24"></use>
        </svg>
      </p>
    </template>

    <template id="answer_incorrect">
      <p class="answer incorrect">
        <svg role="img" aria-labelledby="q1_incorrect" focusable="false" class="pe-icon--remove-lg-24">
          <title id="q1_incorrect">Wrong answer</title>
          <use xlink:href="#remove-lg-24"></use>
        </svg>
      </p>
    </template>

    <template id="alert_correct">
      <h2 class="correct">That's right. Nice work.</h2>
      <p>Lorem ipsum dolor sit amet, nec ne ferri tritani propriae.</p>
    </template>

    <template id="alert_incorrect">
      <h2 class="incorrect">Not quite, but great try!</h2>
      <p>This is part of the procedure for writing an equation from a word problem.</p>
      <template id="hint">
        <h3>Hint</h3>
        <p>Lorem hint text ipsum dolor sit amet, consectetur hint text adipiscing elit.</p>
      </template>
    </template>

    <script>
if (!document.getElementById('pe-icons-sprite')) {
var pe_ajax=new XMLHttpRequest();
pe_ajax.open('GET', 'p-icons-sprite-1.1.svg', true);
pe_ajax.responseType="document";
pe_ajax.onload=function(e){document.body.insertBefore(pe_ajax.responseXML.documentElement,document.body.childNodes[0]);}
pe_ajax.send();}
    </script>

    <script src="base.js"></script>
    <script>
      var LongNameSpacedPearsonTestObject=PO={

          tries: document.querySelector('.tries'),
          form: document.forms[0],
          radios: [].slice.call(document.querySelectorAll('input[type="radio"]')),

          alert_div: document.querySelector('[role=alert]'),

          /* templates */
          correct: document.getElementById('answer_correct'),
          incorrect: document.getElementById('answer_incorrect'),
          alert_correct: document.getElementById('alert_correct'), 
          alert_incorrect: document.getElementById('alert_incorrect'), 

          submit: document.querySelector('button[type="submit"]'),

          init: function() {
            PO.radios.forEach(function(radio) {
              Basis.addEventListener(radio,'focus',PO.enableButton);
              Basis.addEventListener(radio,'focus',PO.cleanSVGs);
            });
            
            Basis.addEventListener(PO.form,'submit',PO.runSubmit);
          },
        
          enableButton: function() {
            PO.submit.removeAttribute('disabled');
            PO.radios.forEach(function(radio) {
              Basis.removeEventListener(radio,'focus',PO.enableButton);
            });
          },

          emptyNode: function(node) {
            while (node.firstChild) node.removeChild(node.firstChild);
          },

          cleanSVGs: function() {
            var p;
            [].slice.call(document.querySelectorAll('.pe-radio')).forEach(function(div) {
              if (p=div.querySelector('.answer')) {
                div.removeChild(p);
              }
            }); 
          },

          runSubmit: function(e) {
            e.preventDefault(); 

            var div,
                answer,
                trys=PO.tries.textContent.charAt(0);

            PO.radios.forEach(function(radio, i) {
              if (radio.checked) {
                div=radio.parentNode;
                answer=i+1;
              }
            });

            PO.cleanSVGs();
            PO.emptyNode(PO.alert_div);

            /* C is correct */
            if (answer==3) {
              PO.tries.textContent = '0 tries left';

              div.appendChild(PO.correct.content.cloneNode(true));

              PO.alert_div.appendChild(PO.alert_correct.content.cloneNode(true));

              /* obviously this should become a new thing that Does Something */
              PO.submit.textContent='Next';
            }
            else {
              trys--;

              div.appendChild(PO.incorrect.content.cloneNode(true));
              PO.alert_div.appendChild(PO.alert_incorrect.content.cloneNode(true));

              if (trys==1) {
                PO.tries.textContent = '1 try left';
                var hint=PO.alert_incorrect.content.querySelector('#hint');
                PO.alert_div.appendChild(hint.content.cloneNode(true));
              }
              else {
                PO.tries.textContent = trys+' tries left';
              }
              PO.submit.textContent='Try again';
            }
          }
      };
      Basis.start(PO.init);
    </script>
  </body>
</html>

